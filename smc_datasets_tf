import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
from tensorflow.keras import layers, models

data = {
    "text": [
        "Win a free iPhone now",           # spam
        "Congratulations you have won",    # spam
        "Free lottery entry click now",    # spam
        "Meeting at 2pm tomorrow",         # ham
        "Project updates attached",        # ham
        "Let's discuss the report",        # ham
        "Exclusive offer only for you",    # spam
        "Your invoice is attached",        # ham
        "Dinner plans for tonight?",       # ham
        "Click to claim your prize",       # spam
    ],
    "label": [1,1,1,0,0,0,1,0,0,1]  # 1 = spam, 0 = not spam
}

df = pd.DataFrame(data)

vectorizer = TfidfVectorizer()
X = vectorizer.fit_transform(df["text"]).toarray()
y = np.array(df["label"])

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

model = models.Sequential([
    layers.Dense(16, activation='relu', input_shape=(X_train.shape[1],)),
    layers.Dense(8, activation='relu'),
    layers.Dense(1, activation='sigmoid')   # output probability
])

model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

model.fit(X_train, y_train, epochs=10, batch_size=2, verbose=1)

loss, acc = model.evaluate(X_test, y_test, verbose=0)
print("\nTest Accuracy:", acc)

new_email = ["Claim your free reward now"]
new_vec = vectorizer.transform(new_email).toarray()

prediction = model.predict(new_vec)[0][0]
print("\nPrediction Score:", prediction)

if prediction > 0.5:
    print("Result: SPAM")
else:
    print("Result: NOT SPAM")
